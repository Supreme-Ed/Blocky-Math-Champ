{
  "version": 3,
  "sources": ["../../../dev/core/src/AudioV2/abstractAudio/mainAudioBus.ts", "../../../dev/core/src/AudioV2/webAudio/webAudioMainBus.ts"],
  "sourcesContent": ["import { AbstractAudioBus } from \"./abstractAudioBus\";\nimport type { AudioEngineV2 } from \"./audioEngineV2\";\nimport type { IAbstractAudioBusOptions } from \"./abstractAudioBus\";\n\n/**\n * Options for creating a main audio bus.\n */\nexport interface IMainAudioBusOptions extends IAbstractAudioBusOptions {}\n\n/**\n * Abstract class representing a main audio bus.\n *\n * Main audio buses are the last bus in the audio graph.\n *\n * Unlike {@link AudioBus} instances, `MainAudioBus` instances have no spatial audio and stereo output capabilities,\n * and they cannot be connected downstream to another audio bus. They only connect downstream to the audio engine's\n * main output.\n *\n * Main audio buses are created by the {@link CreateMainAudioBusAsync} function.\n */\nexport abstract class MainAudioBus extends AbstractAudioBus {\n    protected constructor(name: string, engine: AudioEngineV2) {\n        super(name, engine);\n    }\n}\n", "import type { Nullable } from \"../../types\";\nimport type { AbstractAudioNode } from \"../abstractAudio/abstractAudioNode\";\nimport type { IMainAudioBusOptions } from \"../abstractAudio/mainAudioBus\";\nimport { MainAudioBus } from \"../abstractAudio/mainAudioBus\";\nimport { _WebAudioBaseSubGraph } from \"./subNodes/webAudioBaseSubGraph\";\nimport type { _WebAudioEngine } from \"./webAudioEngine\";\nimport type { IWebAudioInNode, IWebAudioSuperNode } from \"./webAudioNode\";\n\n/** @internal */\nexport class _WebAudioMainBus extends MainAudioBus implements IWebAudioSuperNode {\n    protected _subGraph: _WebAudioBaseSubGraph;\n\n    /** @internal */\n    public override readonly engine: _WebAudioEngine;\n\n    /** @internal */\n    public constructor(name: string, engine: _WebAudioEngine) {\n        super(name, engine);\n\n        this._subGraph = new _WebAudioMainBus._SubGraph(this);\n    }\n\n    /** @internal */\n    public async _init(options: Partial<IMainAudioBusOptions>): Promise<void> {\n        await this._subGraph.init(options);\n\n        if (this.engine.mainOut) {\n            if (!this._connect(this.engine.mainOut)) {\n                throw new Error(\"Connect failed\");\n            }\n        }\n\n        this.engine._addMainBus(this);\n    }\n\n    /** @internal */\n    public override dispose(): void {\n        super.dispose();\n\n        this.engine._removeMainBus(this);\n    }\n\n    /** @internal */\n    public get _inNode() {\n        return this._subGraph._inNode;\n    }\n\n    /** @internal */\n    public get _outNode() {\n        return this._subGraph._outNode;\n    }\n\n    protected override _connect(node: IWebAudioInNode): boolean {\n        const connected = super._connect(node);\n\n        if (!connected) {\n            return false;\n        }\n\n        if (node._inNode) {\n            this._outNode?.connect(node._inNode);\n        }\n\n        return true;\n    }\n\n    protected override _disconnect(node: IWebAudioInNode): boolean {\n        const disconnected = super._disconnect(node);\n\n        if (!disconnected) {\n            return false;\n        }\n\n        if (node._inNode) {\n            this._outNode?.disconnect(node._inNode);\n        }\n\n        return true;\n    }\n\n    /** @internal */\n    public getClassName(): string {\n        return \"_WebAudioMainBus\";\n    }\n\n    private static _SubGraph = class extends _WebAudioBaseSubGraph {\n        protected override _owner: _WebAudioMainBus;\n\n        protected get _downstreamNodes(): Nullable<Set<AbstractAudioNode>> {\n            return this._owner._downstreamNodes ?? null;\n        }\n    };\n}\n"],
  "mappings": ";;;;;;;;;;;;;AAAA,IAoBsB;AApBtB;;;AAoBM,IAAgB,eAAhB,cAAqC,iBAAgB;MACvD,YAAsB,MAAc,QAAqB;AACrD,cAAM,MAAM,MAAM;MACtB;;;;;;ACpBJ,IAMa;AANb;;;AACA;AAKM,IAAO,mBAAP,MAAO,0BAAyB,aAAY;;MAO9C,YAAmB,MAAc,QAAuB;AACpD,cAAM,MAAM,MAAM;AAElB,aAAK,YAAY,IAAI,kBAAiB,UAAU,IAAI;MACxD;;MAGO,MAAM,MAAM,SAAsC;AACrD,cAAM,KAAK,UAAU,KAAK,OAAO;AAEjC,YAAI,KAAK,OAAO,SAAS;AACrB,cAAI,CAAC,KAAK,SAAS,KAAK,OAAO,OAAO,GAAG;AACrC,kBAAM,IAAI,MAAM,gBAAgB;UACpC;QACJ;AAEA,aAAK,OAAO,YAAY,IAAI;MAChC;;MAGgB,UAAO;AACnB,cAAM,QAAO;AAEb,aAAK,OAAO,eAAe,IAAI;MACnC;;MAGA,IAAW,UAAO;AACd,eAAO,KAAK,UAAU;MAC1B;;MAGA,IAAW,WAAQ;AACf,eAAO,KAAK,UAAU;MAC1B;MAEmB,SAAS,MAAqB;AAjDrD;AAkDQ,cAAM,YAAY,MAAM,SAAS,IAAI;AAErC,YAAI,CAAC,WAAW;AACZ,iBAAO;QACX;AAEA,YAAI,KAAK,SAAS;AACd,qBAAK,aAAL,mBAAe,QAAQ,KAAK;QAChC;AAEA,eAAO;MACX;MAEmB,YAAY,MAAqB;AA/DxD;AAgEQ,cAAM,eAAe,MAAM,YAAY,IAAI;AAE3C,YAAI,CAAC,cAAc;AACf,iBAAO;QACX;AAEA,YAAI,KAAK,SAAS;AACd,qBAAK,aAAL,mBAAe,WAAW,KAAK;QACnC;AAEA,eAAO;MACX;;MAGO,eAAY;AACf,eAAO;MACX;;AAEe,qBAAA,YAAY,cAAc,sBAAqB;MAG1D,IAAc,mBAAgB;AAC1B,eAAO,KAAK,OAAO,oBAAoB;MAC3C;;;;",
  "names": []
}
